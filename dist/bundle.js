!function(e){"use strict";class t{constructor(e){this.audioContext=null,this.meter=null,this.debuglog=!1,this.config=e}async init(){window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,document.addEventListener("click",(()=>{this.audioContext.resume()}));try{const e=await navigator.mediaDevices.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}});return this.handleStream(e)}catch(e){throw console.error("getUserMedia threw exception:",e),e}}handleStream(e){const t=this.audioContext.createMediaStreamSource(e);return this.meter=this.createAudioMeter(this.audioContext),t.connect(this.meter),this.meter}createAudioMeter(e){const t=e.createScriptProcessor(2048,1,1),i={volume:0,checkClipping:()=>!1,processor:t};return t.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let n=0;for(let e=0;e<t.length;e++)n+=t[e]*t[e];i.volume=Math.sqrt(n/t.length)},t.connect(e.destination),i}setDebugMode(e){this.debuglog=e}}class i{constructor(e){this.container=e,this.cakeElement=null,this.flameElement=null,this.isBlown=!1}init(){this.cakeElement=document.createElement("div"),this.cakeElement.className="cake",this.createCakeLayers(),this.createCandle(),this.container.appendChild(this.cakeElement)}createCakeLayers(){["top","middle","bottom"].forEach((e=>{const t=document.createElement("div");t.className=`layer layer-${e}`,this.cakeElement.appendChild(t)}));const e=document.createElement("div");e.className="icing",this.cakeElement.appendChild(e);for(let e=1;e<=7;e++){const t=document.createElement("div");t.className=`decoration decoration${e}`,this.cakeElement.appendChild(t)}}createCandle(){const e=document.createElement("div");e.className="candle",this.cakeElement.appendChild(e),this.flameElement=document.createElement("div"),this.flameElement.className="flame",e.appendChild(this.flameElement)}blowOut(){this.isBlown||(this.isBlown=!0,this.flameElement.style.opacity="0",this.flameElement.style.transform="scale(0)","undefined"!=typeof confetti&&confetti({particleCount:100,spread:70,origin:{y:.6}}))}reset(){this.isBlown=!1,this.flameElement.style.opacity="1",this.flameElement.style.transform="scale(1)"}}e.BirthdayApp=class{constructor(){this.audioDetection=new t,this.cake=null,this.isInitialized=!1}async init(){if(this.isInitialized)return;const e=document.getElementById("cake-container");if(e){this.cake=new i(e),this.cake.init();try{const e=await this.audioDetection.init();this.startVolumeMonitoring(e),this.isInitialized=!0}catch(e){console.error("Failed to initialize audio:",e),this.showError("Microphone access is required for this demo.")}}else console.error("Cake container not found")}startVolumeMonitoring(e){const t=()=>{if(!this.cake||this.cake.isBlown)return;e.volume>.15&&this.cake.blowOut(),requestAnimationFrame(t)};t()}showError(e){const t=document.createElement("div");t.className="error-message",t.textContent=e,document.body.appendChild(t)}reset(){this.cake&&this.cake.reset()}}}({});
//# sourceMappingURL=bundle.js.map
